name: Update Profile README with Hashnode Blog Posts

on:
  schedule:
    # Runs every 6 hours
    - cron: '0 */6 * * *'
  workflow_dispatch: # Allows manual trigger
  push:
    branches: [ master, main ]
    paths:
      - '.github/workflows/update-profile-readme.yml'

jobs:
  update-readme:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          repository: codenificient/codenificient
          token: ${{ secrets.PROFILE_TOKEN }}
          
      - name: Update README with Hashnode blog posts
        uses: ./
        with:
          # Hashnode GraphQL API configuration
          hashnode_api_key: ${{ secrets.HASHNODE_API_KEY }}
          github_username: codenificient.hashnode.dev
          
          # README configuration
          readme_path: './README.md'
          max_post_count: '5'
          
          # Git configuration
          gh_token: ${{ secrets.PROFILE_TOKEN }}
          commit_message: 'üìù Update README with latest Hashnode blog posts'
          committer_username: 'blog-post-bot'
          committer_email: 'blog-post-bot@users.noreply.github.com'
          
          # Post formatting
          template: 'default'
          date_format: 'UTC:ddd mmm dd yyyy'
          title_max_length: '80'
          description_max_length: '120'
          
          # Advanced options
          disable_sort: 'false'
          sort_order: 'desc'
          remove_duplicates: 'true'
          enable_keepalive: 'true'
          
      - name: Push changes
        run: |
          git push origin master
